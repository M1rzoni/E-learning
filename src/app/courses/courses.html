<div class="course-container">
  <div class="page-header">
    <h1 class="page-title">ğŸ“š Svi Kursevi</h1>
    
    <div class="header-actions">
      <a *ngIf="isAdmin" routerLink="/add-courses" class="btn-add-course">
        <span class="btn-icon">â•</span>
        Dodaj Novi Kurs
      </a>
      
      <button class="btn-refresh" (click)="loadCourses()">
        <span class="btn-icon">ğŸ”„</span>
        OsvjeÅ¾i
      </button>
    </div>
  </div>

  <div *ngIf="courses.length === 0" class="loading-state">
    <div class="loading-spinner"></div>
    <p>UÄitavanje kurseva...</p>
  </div>

  <div *ngIf="courses.length > 0" class="courses-content">
    <div *ngFor="let category of sortedCategories" class="category-section">
      <div class="category-header">
        <h2 class="category-title">
          <span class="category-icon">{{ getCategoryIcon(category.key) }}</span>
          {{ category.key }}
          <span class="course-count">({{ category.value.length }} kursa)</span>
        </h2>
        <div class="category-actions">
          <button type="button" class="btn-collapse" (click)="toggleCategory(category.key)">
            {{ isCategoryExpanded(category.key) ? 'Sakrij' : 'PrikaÅ¾i' }}
          </button>
        </div>
      </div>

      <div *ngIf="isCategoryExpanded(category.key)" class="courses-grid">
        <div *ngFor="let course of category.value" class="course-card">
          <div class="course-image-container">
            <img 
              *ngIf="course.image && course.image !== 'default-course-image.png' && course.image !== 'default-course-image.jpg'"
              [src]="getImageUrl(course.image)" 
              [alt]="course.title"
              class="course-image"
              (error)="handleImageError($event)"
            />
            <div 
              *ngIf="!course.image || course.image === 'default-course-image.png' || course.image === 'default-course-image.jpg'" 
              class="course-image-placeholder">
              <span class="placeholder-icon">ğŸ“š</span>
            </div>
            
            <div class="course-level-badge" [class]="'level-' + (course.level?.toLowerCase() || 'pocetni')">
              {{ course.level || 'PoÄetni' }}
            </div>
          </div>

          <div class="course-content">
            <h3 class="course-title">
              <a [routerLink]="['/course', course.id]" class="course-link">
                {{ course.title }}
              </a>
            </h3>
            
            <p class="course-description">
              {{ (course.description || '') | slice:0:150 }}...
            </p>

            <div class="course-meta">
              <div class="meta-item">
                <span class="meta-icon">ğŸ’°</span>
                <span class="meta-text">{{ course.price ? (course.price + 'â‚¬') : 'Besplatno' }}</span>
              </div>
              <div class="meta-item">
                <span class="meta-icon">â­</span>
                <span class="meta-text">4.8 (124)</span>
              </div>
            </div>

            <div class="course-actions">
              <button 
                type="button"
                class="btn btn-view"
                [routerLink]="['/course', course.id]"
              >
                <span class="btn-icon">ğŸ‘ï¸</span>
                Pregledaj
              </button>
              
              <button 
                type="button"
                *ngIf="isAdmin"
                class="btn btn-edit"
                (click)="editCourse(course)"
              >
                <span class="btn-icon">âœï¸</span>
                Uredi
              </button>
              
              <button 
                type="button"
                *ngIf="isAdmin"
                class="btn btn-delete"
                (click)="confirmDelete(course.id)"
              >
                <span class="btn-icon">ğŸ—‘ï¸</span>
                ObriÅ¡i
              </button>
            </div>

            <div *ngIf="isAdmin" class="image-upload-section">
              <label class="file-upload-label">
                <input 
                  type="file" 
                  (change)="uploadImage($event, course.id)" 
                  accept="image/*"
                  class="file-input"
                />
                <span class="upload-icon">ğŸ“·</span>
                Promijeni sliku
              </label>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="selectedCourse" class="edit-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h3>âœï¸ Uredi Kurs</h3>
        <button type="button" class="modal-close" (click)="selectedCourse = null">
          &times;
        </button>
      </div>

      <form #courseForm="ngForm" class="edit-form">
        <div class="form-row">
          <div class="form-group">
            <label for="edit-title" class="form-label">Naslov Kursa *</label>
            <input 
              type="text" 
              id="edit-title"
              [(ngModel)]="selectedCourse.title" 
              name="title" 
              class="form-input"
              required
              placeholder="Unesite naslov kursa"
            />
          </div>

          <div class="form-group">
            <label for="edit-category" class="form-label">Kategorija *</label>
            <select 
              id="edit-category"
              [(ngModel)]="selectedCourse.category" 
              name="category" 
              class="form-select"
              required
            >
              <option value="">Odaberite kategoriju</option>
              <option value="Frontend">Frontend</option>
              <option value="Backend">Backend</option>
              <option value="Dizajn">Dizajn</option>
              <option value="Marketing">Marketing</option>
              <option value="Data Science">Data Science</option>
              <option value="Mobile">Mobile Development</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="edit-description" class="form-label">Opis Kursa *</label>
          <textarea 
            id="edit-description"
            [(ngModel)]="selectedCourse.description" 
            name="description" 
            class="form-textarea"
            required
            rows="4"
            placeholder="Detaljno opiÅ¡ite kurs..."
          ></textarea>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="edit-level" class="form-label">Nivo TeÅ¾ine</label>
            <select 
              id="edit-level"
              [(ngModel)]="selectedCourse.level" 
              name="level" 
              class="form-select"
            >
              <option value="PoÄetni">PoÄetni</option>
              <option value="Srednji">Srednji</option>
              <option value="Napredni">Napredni</option>
            </select>
          </div>

          <div class="form-group">
            <label for="edit-price" class="form-label">Cijena (â‚¬)</label>
            <input 
              type="number" 
              id="edit-price"
              [(ngModel)]="selectedCourse.price" 
              name="price" 
              class="form-input"
              min="0"
              step="0.01"
              placeholder="0.00"
            />
          </div>
        </div>

        <div class="form-group" *ngIf="selectedCourse">
          <label class="form-label">Trenutna Slika</label>
          <img
            *ngIf="selectedCourse.image && selectedCourse.image !== 'default-course-image.png' && selectedCourse.image !== 'default-course-image.jpg'"
            [src]="getImageUrl(selectedCourse.image)" 
            class="current-image"
            (error)="handleImageError($event)"
          />
          <div *ngIf="!selectedCourse.image || selectedCourse.image === 'default-course-image.png' || selectedCourse.image === 'default-course-image.jpg'" 
               class="course-image-placeholder">
            <span class="placeholder-icon">ğŸ“š</span>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">Promijeni Sliku</label>
          <label class="file-upload-label">
            <input 
              type="file" 
              (change)="uploadImage($event, selectedCourse.id)" 
              accept="image/*"
              class="file-input"
            />
            <span class="upload-icon">ğŸ“·</span>
            Izaberi novu sliku
          </label>
        </div>

        <div class="form-actions">
          <button 
            type="button" 
            class="btn btn-save"
            (click)="updateCourse()" 
            [disabled]="!courseForm.form.valid || isUpdating"
          >
            <span class="btn-icon" *ngIf="!isUpdating">ğŸ’¾</span>
            <span class="btn-spinner" *ngIf="isUpdating"></span>
            {{ isUpdating ? 'ÄŒuvanje...' : 'SaÄuvaj Promjene' }}
          </button>
          
          <button 
            type="button" 
            class="btn btn-cancel"
            (click)="selectedCourse = null"
            [disabled]="isUpdating"
          >
            <span class="btn-icon">âŒ</span>
            OtkaÅ¾i
          </button>
        </div>
      </form>
    </div>
  </div>
</div>